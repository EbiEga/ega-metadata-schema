{
    "$schema": "https://json-schema.org/draft/2019-09/schema#",
    "$id": "https://raw.githubusercontent.com/EbiEga/ega-metadata-schema/v1.0.0/schemas/EGA.run.json",
    "type": "object",
    "title": "EGA Run metadata schema",
    "meta:version": "1.0.0",
    "required": [
        "RUN_SET"
    ],
    "additionalProperties": false,
    "properties": {
        "RUN_SET": {
            "type": "array",
            "description": "Container for a set of runs and a namespace for establishing referential integrity between them.",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
                "type": "object",
                "required": [
                    "RUN"
                ],
                "properties": {
                    "RUN": {
                        "$ref": "#/definitions/RunType"
                    }
                }
            }
        }
    },
    "definitions": {
        "RunType": {
            "type": "object",
            "description": "A run contains a group of reads generated for a particular experiment.",
            "required": [
                "EXPERIMENT_REF"
            ],
            "allOf": [
                {
                    "$ref": "EGA.common.json#/definitions/ObjectType"
                }
            ],
            "properties": {
                "TITLE": {
                    "type": [
                        "string"
                    ],
                    "description": "Short text that can be used to define submissions in searches or in displays."
                },
                "EXPERIMENT_REF": {
                    "$ref": "EGA.common.json#/definitions/RefObjectType",
                    "description": "Identifies the parent experiment."
                },
                "SPOT_DESCRIPTOR": {
                    "$ref": "EGA.common.json#/definitions/SpotDescriptorType"
                },
                "PLATFORM": {
                    "$ref": "EGA.common.json#/definitions/PlatformType"
                },
                "PROCESSING": {
                    "$ref": "EGA.common.json#/definitions/ProcessingType"
                },
                "RUN_TYPE": {
                    "type": [
                        "object"
                    ],
                    "description": "The type of the run.",
                    "required": [
                        "REFERENCE_ALIGNMENT"
                    ],
                    "properties": {
                        "REFERENCE_ALIGNMENT": {
                            "$ref": "EGA.common.json#/definitions/ReferenceSequenceType"
                        }
                    }
                },
                "DATA_BLOCK": {
                    "type": [
                        "object"
                    ],
                    "description": "",
                    "properties": {
                        "FILES": {
                            "description": "Data files associated with the run",
                            "type": "array",
                            "minItems": 1,
                            "additionalProperties": false,
                            "uniqueItems": true,
                            "items": {
                                "allOf": [
                                    {
                                        "title": "Inherit the overall structure of files",
                                        "$ref": "EGA.common.json#/definitions/runAnalysisFileType"
                                    },
                                    {
                                        "title": "Inherit the costraint on the filetype based on being a Run",
                                        "required": [
                                            "FILE"
                                        ],
                                        "properties": {
                                            "FILE": {
                                                "type": "object",
                                                "required": [
                                                    "filetype"
                                                ],
                                                "properties": {
                                                    "filetype": {
                                                        "$ref": "EGA.common.json#/definitions/runFileTypeEnum"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "member_name": {
                            "type": [
                                "string"
                            ],
                            "description": "Allow for an individual DATA_BLOCK to be associated with a member of a sample pool."
                        }
                    },
                    "required": [
                        "FILES"
                    ]
                },
                "RUN_LINKS": {
                    "type": "array",
                    "description": "Links to resources related to this RUN or RUN set (publication, datasets, online databases).",
                    "minItems": 1,
                    "uniqueItems": true,
                    "items": {
                        "type": "object",
                        "properties": {
                            "RUN_LINK": {
                                "$ref": "EGA.common.json#/definitions/LinkType"
                            }
                        }
                    }
                },
                "RUN_ATTRIBUTES": {
                    "type": "array",
                    "minItems": 1,
                    "uniqueItems": true,
                    "description": "Properties and attributes of a RUN.  These can be entered as free-form tag-value pairs. For certain studies, submitters may be asked to follow a community established ontology when describing the work.",
                    "items": {
                        "type": "object",
                        "required": [
                            "RUN_ATTRIBUTE"
                        ],
                        "properties": {
                            "RUN_ATTRIBUTE": {
                                "$ref": "./EGA.common.json#/definitions/AttributeType"
                            }
                        }
                    }
                }
            }
        }
    }
}